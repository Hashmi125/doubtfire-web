<emoji-mart
  [darkMode]="false"
  [isNative]="true"
  [hideRecent]="false"
  [hidden]="!showEmojiPicker"
  class="emoji-picker"
  title="Pick your emojiâ€¦"
  emoji="thumbsup"
  (emojiSelect)="addEmoji($event)"
></emoji-mart>

@if (this.task) {
  <div id="replyContainer" [hidden]="this.originalComment === null">
    <div>
      <div class="replying-wrap">
        Replying to:
        <b>{{ this.originalComment !== null ? this.originalComment.author.name : '' }}</b>
        <button
          id="cancelReplyButton"
          (click)="cancelReply()"
          mat-icon-button
          aria-label="Close reply"
        >
          <mat-icon inline="true" aria-label="Quit cross icon">close</mat-icon>
        </button>
      </div>
      <p>{{ this.originalComment !== null ? this.originalComment.text : '' }}</p>
    </div>
  </div>
}

<mat-action-list
  [hidden]="!this.emojiSearchMode || !(this.emojiSearchResults?.length > 0)"
  dense
  id="emojiSearchResults"
>
<mat-action-list [hidden]="!this.emojiSearchMode || !(this.emojiSearchResults?.length > 0)" dense id="emojiSearchResults">
  <ng-container *ngFor="let emoji of this.emojiSearchResults">
    <mat-list-item (click)="emojiSelected(emoji.native)">
      <div class="flex items-center">
<<<<<<< Updated upstream
        <ngx-emoji class="align-items: center" [emoji]="emoji" set="apple" size="20"></ngx-emoji>
=======
        <ngx-emoji [emoji]="emoji" set="apple" size="20"></ngx-emoji>
>>>>>>> Stashed changes
        <div class="emoji-details flex flex-col items-center justify-start">
          <div class="font-bold text-sm">{{ emoji.name }}</div>
          <div class="text-xs">{{ emoji.colons }}</div>
        </div>
      </div>
    </mat-list-item>
  </ng-container>
</mat-action-list>

<form
  [hidden]="!task"
  style="display: flex; width: 100%"
  class="input-group col-sm-12 comment-submitter"
  ng-submit="addComment()"
  role="form"
>
  <div class="flex justify-around items-center composer-container">
    <div class="composer-action-group" [@shrinkgrow]="$userIsTyping | async">
<<<<<<< Updated upstream
      <!-- if active -->
      <div class="flex items-center">
        @if ($userIsTyping | async) {
=======
      <div class="flex items-center">
        @if (this.$userIsTyping | async) {
>>>>>>> Stashed changes
          <button
            (click)="this.$userIsTyping.next(false); this.recording = false"
            matTooltip="Expand action buttons"
            matTooltipShowDelay="400"
            mat-icon-button
            class="btn-no-outline"
            type="button"
            aria-label="Expand action buttons"
          >
            <mat-icon>{{ this.recording ? 'cancel' : 'chevron_right' }}</mat-icon>
          </button>
        }

<<<<<<< Updated upstream
        @if (isStaff) {
=======
        @if (this.isStaff) {
>>>>>>> Stashed changes
          <button
            [hidden]="this.$userIsTyping | async"
            matTooltip="Create a Real Talk discussion"
            matTooltipShowDelay="400"
            mat-icon-button
            class="btn-no-outline"
            type="button"
            aria-label="launch real talk took"
            (click)="openDiscussionComposer()"
          >
            <mat-icon class="message-inbox-icon">mark_chat_read</mat-icon>
          </button>
        }

        <button
          [hidden]="this.$userIsTyping | async"
          matTooltip="Attach a file"
          matTooltipShowDelay="400"
          mat-icon-button
          class="btn-no-outline"
          type="button"
          (click)="openFile()"
          aria-label="attach a file icon button"
        >
          <mat-icon class="message-inbox-icon">attach_file</mat-icon>
          <input
            #uploader
            type="file"
            multiple="multiple"
            accept="audio/*,image/*,.pdf"
            style="display: none"
            (change)="uploadFiles($event.target.files)"
          />
        </button>

        <button
          [hidden]="this.$userIsTyping | async"
          matTooltip="Send a recording"
          matTooltipShowDelay="400"
          mat-icon-button
          class="btn-no-outline"
          type="button"
          aria-label="audio recording button"
          (click)="recordingMode()"
        >
          <mat-icon class="message-inbox-icon">mic</mat-icon>
        </button>
      </div>
    </div>
    <div
      id="textFieldContainer"
      [class.active]="this.$userIsTyping | async"
      [ngClass]="{recording: this.recording}"
    >
      <div
        [hidden]="this.recording"
        (focus)="this.$userIsTyping.next(true)"
        (blur)="this.$userIsTyping.next(false)"
        [class.active]="(this.$userIsTyping | async) === false"
        #commentInput
        id="textField"
        [attr.contenteditable]="this.contentEditableValue() && !this.recording"
        (keydown.enter)="this.send($event)"
        (keydown)="this.keyTyped()"
        placeholder="Aa"
        name="commentComposer"
      ></div>
      @if (this.recording) {
        <audio-comment-recorder
          style="display: flex; justify-content: center; width: 100%"
          [task]="this.task"
        ></audio-comment-recorder>
      }
      <div id="innerButtons" [hidden]="this.recording">
        <mat-icon
          matTooltip="Choose an emoji"
          matTooltipShowDelay="400"
          id="emojiButton"
          (click)="showEmojiPicker = !showEmojiPicker"
          aria-label="Emoji picker button"
          >emoji_emotions</mat-icon
        >
      </div>
    </div>
  </div>
</form>
